<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Quiz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container mt-5">
        <!-- Login Page -->
        <div id="login-page" class="text-center">
            <h1>Welcome to JavaScript Quiz</h1>
            <form id="login-form">
                <div class="mb-3">
                    <input type="text" id="username" class="form-control" placeholder="Enter your name" required>
                </div>
                <div class="mb-3">
                    <input type="email" id="email" class="form-control" placeholder="Enter your email" required>
                </div>
                <button type="submit" class="btn btn-primary">Start Quiz</button>
            </form>
        </div>

        <!-- Quiz Page -->
        <div id="quiz-page" class="hidden">
            <h2>JavaScript Quiz</h2>
            <form id="quiz-form">
                <div id="questions-container"></div>
                <button type="submit" class="btn btn-success mt-3">Submit</button>
            </form>
        </div>

        <!-- Result Page -->
        <div id="result-page" class="hidden">
            <h2>Quiz Results</h2>
            <div id="results-container"></div>
            <button id="view-ranking" class="btn btn-primary mt-3">View Ranking</button>
        </div>

        <!-- Dashboard Page -->
        <div id="dashboard-page" class="hidden">
            <h2>Dashboard</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Score</th>
                        <th>Rank</th>
                    </tr>
                </thead>
                <tbody id="dashboard-container"></tbody>
            </table>
        </div>
    </div>

    <script>
        const questions = [
            { question: "Which method is used to remove the last element from an array?", options: ["pop()", "shift()", "push()", "unshift()"], correct: 0 },
            { question: "Which method is used to join all elements of an array into a string?", options: ["join()", "concat()", "slice()", "splice()"], correct: 0 },
            { question: "Which method creates a new array with all elements that pass a test?", options: ["filter()", "map()", "reduce()", "forEach()"], correct: 0 },
            { question: "Which of the following is not a valid JavaScript data type?", options: ["Number", "String", "Float", "Boolean"], correct: 2 },
            { question: "What will the following code output: `console.log(3 + '3')`?", options: ["33", "6", "NaN", "Error"], correct: 0 }
        ];

        let users = [];
        let currentUser = null;

        // DOM elements
        const loginPage = document.getElementById('login-page');
        const quizPage = document.getElementById('quiz-page');
        const resultPage = document.getElementById('result-page');
        const dashboardPage = document.getElementById('dashboard-page');
        const questionsContainer = document.getElementById('questions-container');
        const resultsContainer = document.getElementById('results-container');
        const dashboardContainer = document.getElementById('dashboard-container');

        // Show a page
        function showPage(page) {
            [loginPage, quizPage, resultPage, dashboardPage].forEach(p => p.classList.add('hidden'));
            page.classList.remove('hidden');
        }

        // Login form submission
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const email = document.getElementById('email').value.trim();

            if (!username || !email) return alert('Please fill in both fields.');

            currentUser = { name: username, email, score: 0 };
            if (!users.some(user => user.email === email)) users.push(currentUser);

            loadQuestions();
            showPage(quizPage);
        });

        // Load questions
        function loadQuestions() {
            questionsContainer.innerHTML = '';
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('mb-3');
                questionDiv.innerHTML = `
                    <p>${index + 1}. ${q.question}</p>
                    ${q.options.map((opt, i) => `
                        <div>
                            <input type="radio" name="question${index}" value="${i}" id="q${index}o${i}" required>
                            <label for="q${index}o${i}">${opt}</label>
                        </div>
                    `).join('')}
                `;
                questionsContainer.appendChild(questionDiv);
            });
        }

        // Quiz form submission
        document.getElementById('quiz-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            let score = 0;
            const userAnswers = [];

            questions.forEach((q, index) => {
                const answer = formData.get(`question${index}`);
                userAnswers.push(answer);
                if (parseInt(answer) === q.correct) score++;
            });

            if (currentUser) {
                const user = users.find(u => u.email === currentUser.email);
                if (user) user.score = Math.max(user.score, score);
            }

            displayResults(userAnswers, score);
            showPage(resultPage);
        });

        // Display results
        function displayResults(userAnswers, score) {
            resultsContainer.innerHTML = '';
            resultsContainer.innerHTML += `<p>Your Score: ${score}/${questions.length}</p>`;

            questions.forEach((q, index) => {
                resultsContainer.innerHTML += `
                    <p>${index + 1}. ${q.question}</p>
                    <p>Correct Answer: ${q.options[q.correct]}</p>
                    <p>Your Answer: ${q.options[userAnswers[index]] || 'No Answer'}</p>
                `;
            });
        }

        // View ranking
        document.getElementById('view-ranking').addEventListener('click', function() {
            users.sort((a, b) => b.score - a.score);
            dashboardContainer.innerHTML = '';
            users.forEach((user, index) => {
                dashboardContainer.innerHTML += `
                    <tr>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${user.score}</td>
                        <td>${index + 1}</td>
                    </tr>
                `;
            });
            showPage(dashboardPage);
        });
    </script>
</body>
</html>
